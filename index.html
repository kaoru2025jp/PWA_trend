<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>計算結果送信</title>
<style>
  body {
    font-family: sans-serif;
    padding: 20px;
  }
  input {
    font-size: 16px;
    padding: 5px;
    width: 200px;
    display: block;
    margin-bottom: 8px;
  }
  button {
    font-size: 16px;
    padding: 8px 16px;
    margin-top: 10px;
  }
</style>
</head>
<body>

<h2>計算（(S1 - S2) / option）</h2>

<input id="s1" placeholder="S1">
<input id="s2" placeholder="S2">
<input id="option" placeholder="option">

<button onclick="calcAndSend()">計算して送信</button>

<p>結果 T：<span id="result"></span></p>

<script>
function calcAndSend() {
  const S1 = Number(document.getElementById("s1").value);
  const S2 = Number(document.getElementById("s2").value);
  const option = Number(document.getElementById("option").value);

  if (isNaN(S1) || isNaN(S2) || isNaN(option) || option === 0) {
    alert("数値を正しく入力してください（option は 0 以外）");
    return;
  }

  // ① 正しい計算式
  const T = ((S1 - S2) / option).toFixed(2);

  // 画面表示（確認用）
  document.getElementById("result").textContent = T;

  // ② 成功実績のある JSONP 送信方式
  const GAS_URL =
    "https://script.google.com/macros/s/AKfycbxc_BMR_2J0nmmfDOGQGCE7x_AiKDunuhGj7O5g6D3dS5FuHg4SIXgnS5IN0eGrMNVy2w/exec";

  const script = document.createElement("script");
  script.src =
    GAS_URL +
    "?numbers=" + encodeURIComponent(T) +
    "&callback=handleResponse";

  document.body.appendChild(script);
}

function handleResponse(res) {
  if (res.status === "ok") {
    alert("計算結果を記録しました");
  }
}
</script>

</body>
</html>

