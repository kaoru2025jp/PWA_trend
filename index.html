<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>計算書</title>

<style>
  body {
    font-family: sans-serif;
    padding: 20px;
    line-height: 1.6;
  }
  input, button {
    font-size: 16px;
    padding: 6px;
    margin: 6px 0;
    width: 100%;
    max-width: 300px;
  }
</style>
</head>

<body>

<h2>計算書</h2>

<label>S1</label>
<input id="s1" type="number" step="any">

<label>S2</label>
<input id="s2" type="number" step="any">

<label>option</label>
<input id="option" type="number" step="any">

<button onclick="calc()">計算して送信</button>

<p>T = <strong><span id="result">---</span></strong></p>

<script>
/* ========= GAS URL ========= */
const GAS_URL =
  "https://script.google.com/macros/s/AKfycbyr7rjpAiGwoKKVdp8jCmupcE86VBlCoMyHAAmSOjJnUbpH67onLQudaZd2lS9FOBprOQ/exec";

/* ========= 計算＋送信 ========= */
function calc() {
  const s1 = parseFloat(document.getElementById("s1").value);
  const s2 = parseFloat(document.getElementById("s2").value);
  const option = parseFloat(document.getElementById("option").value);

  if (isNaN(s1) || isNaN(s2) || isNaN(option) || option === 0) {
    alert("数値を正しく入力してください");
    return;
  }

  // (S1 - S2) / option = T
  const t = (s1 - s2) / option;

  // 小数点2桁固定
  const value = t.toFixed(2);

  // 画面表示
  document.getElementById("result").textContent = value;

  // JSONP送信（成功実績方式）
  const script = document.createElement("script");
  script.src =
    GAS_URL +
    "?value=" + encodeURIComponent(value) +
    "&callback=handleResponse";

  document.body.appendChild(script);
}

/* ========= GAS 応答 ========= */
function handleResponse(res) {
  if (res && res.status === "ok") {
    console.log("GAS 送信成功");
  } else {
    console.log("GAS 応答エラー");
  }
}
</script>

</body>
</html>
